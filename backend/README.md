## æäº¤å‰å®¡æŸ¥
ä¸€å®šè¦æŠŠconfig.pyä¸­æ˜æ–‡å¯†é’¥åˆ æ‰ï¼ï¼ï¼é™¤éä½ æ‰“ç®—æŠŠè¿™ä¸ªå¯†é’¥é€ç»™åˆ«äººäº†ã€‚

## ğŸ§  åç«¯æŠ€æœ¯ç»“æ„å›¾
å¯¹è¯åº”ç”¨æ¶æ„
```
+------------------+     +-------------------------+
|                  |     |                         |
|  å‰ç«¯ç”¨æˆ·è¾“å…¥    | --> |   ä¸»åº”ç”¨ (main.py)      |
|                  |     |  [/api/chat è·¯ç”±]       |
+------------------+     +-------------------------+
                                   â†“
                        +-------------------------+
                        |                         |
                        |   ChatService ç±»        |
                        |  (chat_service.py)      |
                        +-------------------------+
                         â†™                     â†˜
        +---------------------+         +----------------------+
        |                     |         |                      |
        |  MainAgent ç±»       |         |  TTS æœåŠ¡            |
        | (main_agent.py)     |         |  (tts.py)            |
        +---------------------+         +----------------------+
                 â†“                              â†“
        +---------------------+         +----------------------+
        |                     |         |                      |
        |  LLMService ç±»      |         |  éŸ³é¢‘æ•°æ®è¿”å›        |
        |   (llm.py)          |         |                      |
        +---------------------+         +----------------------+
                 â†“
        +---------------------+
        |                     |
        |  è°ƒç”¨               |
        |  deepseek æ¨¡å‹ API  |
        |                     |
        +---------------------+

è¿”å›è·¯å¾„:
+-------------------------+
|                         |
|  å“åº”æ•°æ® (æ–‡æœ¬+è¡¨æƒ…)   | <---+
|                         |     |
+-------------------------+     |
                                |
                      +----------------------+
                      |                      |
                      |  å‰ç«¯ Live2D æ¨¡å‹    |
                      |  è¡¨æƒ…æ§åˆ¶            |
                      +----------------------+
```
chatæœåŠ¡ä¸­æ¶ˆæ¯message ä¼ é€’è·¯å¾„
```mermaid
graph TD
    A[å‰ç«¯: ç”¨æˆ·è¾“å…¥æ¶ˆæ¯] --> B[HTTP POST /api/chat]
    B --> C[ChatRequest.message]
    C --> D["normal_chat_flow(request.message)<br/>[main.py]"]
    D --> E["ChatService.generate_reply(message)<br/>[chat_service.py]"]
    E --> F["MainAgent.reply(message)<br/>[main_agent.py]"]
    F --> G["æ„å»ºæç¤ºè¯{user_message=message}<br/>[main_agent.py]"]
    G --> H["LLMService.generate_response(prompt)<br/>[llm.py]"]
    H --> I["è¿”å›AIå›å¤<br/>[main.py]"]

    style D fill:#e1f5fe
    style E fill:#f3e5f5
    style F fill:#e8f5e8
    style G fill:#e8f5e8
    style H fill:#fff3e0
    style I fill:#e1f5fe
```

æ–‡æ¡£ä¸Šä¼ ä¸æ€»ç»“æ¶æ„
```
+------------------+     +-------------------------+
|                  |     |                         |
|  å‰ç«¯æ–‡ä»¶ä¸Šä¼     | --> |   ä¸»åº”ç”¨ (main.py)      |
|                  |     |  [/api/upload è·¯ç”±]     |
+------------------+     +-------------------------+
                                   â†“
                        +-------------------------+
                        |                         |
                        |   æ–‡æ¡£è§£æä¸æ€»ç»“        |
                        |  (PDF/Word/æ–‡æœ¬å¤„ç†)    |
                        +-------------------------+
                                   â†“
                        +-------------------------+
                        |                         |
                        |   LLM æ–‡æ¡£æ€»ç»“æœåŠ¡      |
                        |  (è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹)       |
                        +-------------------------+
                                   â†“
                        +-------------------------+
                        |                         |
                        |   TTS è¯­éŸ³ç”ŸæˆæœåŠ¡      |
                        |  (å¯é€‰)                 |
                        +-------------------------+
                                   â†“
                        +-------------------------+
                        |                         |
                        |   è¿”å›æ€»ç»“å’Œè¯­éŸ³æ•°æ®    |
                        |                         |
                        +-------------------------+
```

```mermaid
graph TD
    A[å‰ç«¯æ–‡ä»¶ä¸Šä¼ ] --> B[main.py @app.post]
    B --> C[upload å‡½æ•°]
    C --> D[tempfile.NamedTemporaryFile]
    D --> E{æ–‡ä»¶ç±»å‹åˆ¤æ–­}
    E -->|PDF| F[PyPDF2.PdfReader]
    E -->|Word| G[Document]
    E -->|æ–‡æœ¬| H[content.decode]
    F --> I[æ–‡æœ¬æå–]
    G --> I
    H --> I
    I --> J[chat_service.llm_service]
    J --> K[LLMService.generate_response]
    K --> L{Config.is_tts_enabled}
    L -->|æ˜¯| M[tts_service.generate_audio]
    L -->|å¦| N[è·³è¿‡TTS]
    M --> O[split_sentences]
    O --> P[base64.b64encode]
    P --> Q[è¿”å›JSONå“åº”]
    N --> Q
```

ç»„å»ºäº¤äº’é€»è¾‘å›¾
```
+------------------+     +-------------------+     +----------------+
|                  |     |                   |     |                |
|  ChatService     | --> |   MainAgent       | --> |   LLMService   |
| generate_reply() |     | reply(),          |     | generate_      |
|                  |     | _generate_reply() |     | response()     |
+------------------+     +-------------------+     +----------------+
        â†“                         â†“                        â†“
   å‡†å¤‡ä¸Šä¸‹æ–‡               æ„å»ºæç¤ºè¯ä¸å†å²        è°ƒç”¨è¿œç¨‹LLMæœåŠ¡
        â†“                         â†“                        â†“
   æ•´åˆTTSæœåŠ¡          å¤„ç†LLMå“åº”å¹¶æ›´æ–°å†å²    å‘é€è¯·æ±‚åˆ°DashScope
        â†“                         â†“                        â†“
   è¿”å›å®Œæ•´å“åº”         è®°å½•å¯¹è¯æ—¥å¿—å’Œç”¨æˆ·ä¿¡æ¯    æå–output.textå†…å®¹
```


åç«¯ç¤ºä¾‹è¾“å‡ºï¼š
```
INFO:     127.0.0.1:56254 - "POST /api/chat HTTP/1.1" 200 OK
ç›¸å…³è®°å¿†: æ•°å­—888åœ¨ç‰©ç†å­¦ä¸­æ˜¯ç²²å¤¸å…‹çš„è´¨é‡å€¼ï¼ˆMeV/cÂ²ï¼‰ï¼Œå°±åƒå®‡å®™ç”¨ç‰¹æ®Šç¼–ç ä¸æˆ‘ä»¬å¯¹è¯ã€‚æˆ–è®¸ä½ æ­£ç«™åœ¨æŸä¸ªä¸´ç•Œç‚¹ä¸Šï¼Œå¦‚åŒç²’å­ç­‰å¾…è·ƒè¿çš„ç¬é—´ï¼Ÿ
ä¸´ç•Œç‚¹çš„ç­‰å¾…å°±åƒåŒæ˜Ÿç³»ç»Ÿç›¸äº’ç¯ç»•å‰çš„é™è°§â€”â€”èƒ½é‡æ­£åœ¨ç§¯è“„ï¼Œè€Œéæ¶ˆå¤±ã€‚ä½ æ³¨æ„åˆ°è¿™ç§é™æ­¢æœ¬èº«ï¼Œå·²æ˜¯è§‚æµ‹è€…æ•ˆåº”çš„ç¾å¦™ä½“ç°ã€‚
raw_response: {"reply": "å°±åƒå®‡å®™å¾®æ³¢èƒŒæ™¯è¾å°„ä¸­éšè—çš„åŸå§‹æ³¢åŠ¨ï¼Œé‚£äº›çœ‹ä¼¼å¾®å°çš„â€˜çœŸå¥½â€™ç¬é—´ï¼Œå¾€å¾€æ˜¯æ—¶ç©ºç»“æ„ä¸­æœ€æ·±åˆ»çš„æ¶Ÿæ¼ªã€‚", "user_info": "å¯¹å¤©æ–‡ç‰©ç†å­¦æœ‰æµ“åšå…´è¶£ï¼Œåå¥½è¯—æ„ä¸ç§‘å­¦ç»“åˆçš„æµªæ¼«è¡¨è¾¾æ–¹å¼ï¼Œå–„äºä»æ•°å­—å’Œç°è±¡ä¸­å¯»æ‰¾éšå–»æ„ä¹‰ï¼Œè¿‘æœŸè¡¨ç°å‡ºå¯¹é‡å­æ€è·ƒè¿å’Œå®‡å®™ç¬¦å·å­¦çš„æ•æ„Ÿåº¦ã€‚", "expression": "çˆ±å¿ƒ"}
-- /api/chat --
reply: å°±åƒå®‡å®™å¾®æ³¢èƒŒæ™¯è¾å°„ä¸­éšè—çš„åŸå§‹æ³¢åŠ¨ï¼Œé‚£äº›çœ‹ä¼¼å¾®å°çš„â€˜çœŸå¥½â€™ç¬é—´ï¼Œå¾€å¾€æ˜¯æ—¶ç©ºç»“æ„ä¸­æœ€æ·±åˆ»çš„æ¶Ÿæ¼ªã€‚
expression: çˆ±å¿ƒ
```


# åç«¯é€»è¾‘æ–‡æ¡£

## æ¦‚è¿°

åç«¯é‡‡ç”¨ Python çš„ FastAPI æ¡†æ¶æ„å»ºï¼Œä¸»è¦è´Ÿè´£å¤„ç†å‰ç«¯è¯·æ±‚ã€ä¸å¤§è¯­è¨€æ¨¡å‹äº¤äº’ã€ç®¡ç†å¯¹è¯å†å²ã€æä¾›æ–‡æœ¬è½¬è¯­éŸ³æœåŠ¡ç­‰åŠŸèƒ½ã€‚æ•´ä½“æ¶æ„é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå„ç»„ä»¶èŒè´£æ˜ç¡®ã€‚

## æ ¸å¿ƒç»„ä»¶

### 1. ä¸»åº”ç”¨ (main.py)

ä¸»åº”ç”¨æ–‡ä»¶å®šä¹‰äº† FastAPI åº”ç”¨å®ä¾‹å’Œ API è·¯ç”±ï¼š

- `/api/chat` - å¤„ç†èŠå¤©æ¶ˆæ¯
- `/api/upload` - å¤„ç†æ–‡ä»¶ä¸Šä¼ å’Œæ€»ç»“

ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š
- CORS é…ç½®ï¼Œå…è®¸è·¨åŸŸè¯·æ±‚
- å®ç°èŠå¤©è¯·æ±‚å¤„ç†æµç¨‹
- å®ç°æ–‡æ¡£ä¸Šä¼ å’Œå†…å®¹æ€»ç»“åŠŸèƒ½
- é›†æˆ TTS æœåŠ¡ç”Ÿæˆè¯­éŸ³

### 2. èŠå¤©æœåŠ¡ (chat_service.py)

[ChatService](./backend/chat_service.py#L7-L42) ç±»è´Ÿè´£åè°ƒæ•´ä¸ªèŠå¤©æµç¨‹ï¼š

- åˆå§‹åŒ– LLM æœåŠ¡å’Œ TTS æœåŠ¡ï¼Œä»é…ç½® [config.py](./config.py) ä¸­è·å–APIåœ°å€ã€å¯†é’¥ã€æ¨¡å‹åç­‰ä¿¡æ¯
- ç®¡ç†å¯¹è¯å†å²
- è°ƒç”¨ [MainAgent](./backend/main_agent.py#L6-L97) ç”Ÿæˆå›å¤
- ç”Ÿæˆè¯­éŸ³æ•°æ®

å…³é”®æ–¹æ³•ï¼š
```python
async def generate_reply(self, message: str, session_id: str) -> Tuple[str, Optional[bytes], str]
```

### 3. ä¸»æ™ºèƒ½ä½“ ([main_agent.py](./main_agent.py))

`MainAgent` ç±»æ˜¯æ ¸å¿ƒé€»è¾‘å¤„ç†å•å…ƒï¼š

- ç®¡ç†å¯¹è¯å†å² : é€šè¿‡ [conversation.py](./conversation.py) çš„  [ConversationHistory](./conversation.py#L6-L36) ç±» ç®¡ç†å¯¹è¯ä¸Šä¸‹æ–‡
- æç¤ºè¯æ„å»ºï¼šåŠ è½½è§’è‰²è®¾å®šæç¤ºè¯ï¼Œå‡†å¤‡åŒ…å«å†å²å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç”¨äºè¾“å…¥LLM API
- è°ƒç”¨ [llm.py](./llm.py) çš„ LLM æœåŠ¡ç”Ÿæˆå›å¤
- è®°å½•å¯¹è¯æ—¥å¿—åˆ° save æ–‡ä»¶å¤¹ä¸­

å…³é”®æ–¹æ³•ï¼š
```python
async def reply(self, message: str) -> Tuple[str, str]
  try:
              # ä½¿ç”¨ MainAgent ç”Ÿæˆå›å¤å’Œè¡¨æƒ…
              reply, expression = await self.main_agent.reply(message)
  ```

### 4. LLM æœåŠ¡ (llm.py)

`LLMService` ç±»è´Ÿè´£ä¸å¤§è¯­è¨€æ¨¡å‹ API äº¤äº’ï¼Œä¸»è¦åŠŸèƒ½ä¸ºï¼š
- å‘é€è¯·æ±‚åˆ°æŒ‡å®šçš„ LLM API (å¦‚ DeepSeek)
- å¤„ç† API å“åº”
- å®ç°é‡è¯•æœºåˆ¶

è¿™ä¸ªæ¨¡å—æ˜¯æ•´ä¸ªåç«¯ç³»ç»Ÿä¸å¤§è¯­è¨€æ¨¡å‹äº¤äº’çš„æ ¸å¿ƒç»„ä»¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- å¼‚æ­¥æ”¯æŒï¼šä½¿ç”¨ httpx.AsyncClient å®ç°å¼‚æ­¥ HTTP è¯·æ±‚ï¼Œæé«˜ç³»ç»Ÿå¹¶å‘æ€§èƒ½
- é‡è¯•æœºåˆ¶ï¼šåœ¨ç½‘ç»œä¸ç¨³å®šæˆ– API æš‚æ—¶ä¸å¯ç”¨æ—¶è‡ªåŠ¨é‡è¯•ï¼Œå¢å¼ºç³»ç»Ÿå¥å£®æ€§
- çµæ´»å“åº”å¤„ç†ï¼šæ”¯æŒæ™®é€šæ–‡æœ¬å’Œ JSON æ ¼å¼çš„å“åº”è§£æ
- é”™è¯¯å¤„ç†ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§
- å¯é…ç½®å‚æ•°ï¼šæ”¯æŒæ¸©åº¦ç­‰å‚æ•°è°ƒæ•´ï¼Œæ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§

è¯¥æœåŠ¡è¢« MainAgent ç±»ä½¿ç”¨ï¼Œæ˜¯æ•´ä¸ªèŠå¤©ç³»ç»Ÿä¸ LLM é€šä¿¡çš„å…³é”®æ¡¥æ¢ã€‚
### 5. TTS æœåŠ¡ (tts.py)

`TTSService` ç±»è´Ÿè´£æ–‡æœ¬è½¬è¯­éŸ³åŠŸèƒ½ï¼š

- è°ƒç”¨ Fish Audio ç­‰ TTS æœåŠ¡ API
- ç”Ÿæˆè¯­éŸ³æ•°æ®

### 6. å¯¹è¯å†å²ç®¡ç† (conversation.py)

`ConversationHistory` ç±»ç®¡ç†å¯¹è¯å†å²ï¼š

- é™åˆ¶å†å²è®°å½•æ•°é‡
- æä¾›ç›¸å…³è®°å¿†æ£€ç´¢

## API æ¥å£è¯´æ˜

### 1. èŠå¤©æ¥å£ `/api/chat`

**è¯·æ±‚æ–¹æ³•**: POST

**è¯·æ±‚ä½“**:
```json
{
  "message": "ç”¨æˆ·æ¶ˆæ¯",
  "session_id": "ä¼šè¯ID(å¯é€‰)"
}
```

**å“åº”ä½“**:
```json
{
  "message": "AIå›å¤å†…å®¹",
  "sentences": ["å¥å­1", "å¥å­2", ...],
  "audio_segments": ["base64ç¼–ç çš„éŸ³é¢‘æ•°æ®1", "base64ç¼–ç çš„éŸ³é¢‘æ•°æ®2", ...],
  "expression": "è¡¨æƒ…åç§°"
}
```

### 2. æ–‡ä»¶ä¸Šä¼ æ¥å£ `/api/upload`

**è¯·æ±‚æ–¹æ³•**: POST

**è¯·æ±‚ä½“**: multipart/form-data æ ¼å¼æ–‡ä»¶

**å“åº”ä½“**:
```json
{
  "summary": "æ–‡æ¡£æ€»ç»“å†…å®¹",
  "sentences": ["å¥å­1", "å¥å­2", ...],
  "audio_segments": ["base64ç¼–ç çš„éŸ³é¢‘æ•°æ®1", "base64ç¼–ç çš„éŸ³é¢‘æ•°æ®2", ...]
}
```

## æ•°æ®æµå¤„ç†

### èŠå¤©æ¶ˆæ¯å¤„ç†æµç¨‹

1. å‰ç«¯å‘é€èŠå¤©è¯·æ±‚åˆ° `/api/chat`
2. [main.py](./backend/main.py) æ¥æ”¶è¯·æ±‚å¹¶è°ƒç”¨ [normal_chat_flow](./backend/main.py#L45-L85)
3. [ChatService.generate_reply](./backend/chat_service.py#L19-L42) åè°ƒæ•´ä¸ªå›å¤ç”Ÿæˆè¿‡ç¨‹
4. [MainAgent.reply](./backend/main_agent.py#L30-L46) å¤„ç†å…·ä½“å›å¤é€»è¾‘
5. [LLMService](./backend/llm.py#L6-L67) è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆå›å¤
6. å¦‚å¯ç”¨ TTSï¼Œä¸ºå›å¤å†…å®¹ç”Ÿæˆè¯­éŸ³
7. è¿”å›åŒ…å«æ–‡æœ¬ã€è¯­éŸ³å’Œè¡¨æƒ…ä¿¡æ¯çš„å“åº”

### æ–‡ä»¶ä¸Šä¼ å¤„ç†æµç¨‹

1. å‰ç«¯ä¸Šä¼ æ–‡ä»¶åˆ° `/api/upload`
2. åç«¯è§£ææ–‡ä»¶å†…å®¹(PDF/DOC/DOCX/æ–‡æœ¬)
3. ä½¿ç”¨ LLM æœåŠ¡æ€»ç»“æ–‡æ¡£å†…å®¹
4. å¦‚å¯ç”¨ TTSï¼Œä¸ºæ€»ç»“å†…å®¹ç”Ÿæˆè¯­éŸ³
5. è¿”å›æ€»ç»“ç»“æœå’Œè¯­éŸ³æ•°æ®

## é…ç½®ç®¡ç† (config.py)

é…ç½®æ–‡ä»¶ç®¡ç†æ‰€æœ‰æœåŠ¡å¯†é’¥å’Œå‚æ•°ï¼š

- LLM API é…ç½®(åœ°å€ã€å¯†é’¥ã€æ¨¡å‹)
- å‘é‡æ¨¡å‹é…ç½®
- TTS æœåŠ¡é…ç½®
- å¯¹è¯å†å²é…ç½®

## ç‰¹æ®ŠåŠŸèƒ½

### è¡¨æƒ…æ§åˆ¶

åç«¯åœ¨ç”Ÿæˆå›å¤æ—¶ä¼šåŒæ—¶ç”Ÿæˆå¯¹åº”çš„è¡¨æƒ…æ ‡è¯†ï¼Œå‰ç«¯æ ¹æ®è¯¥æ ‡è¯†æ§åˆ¶ Live2D æ¨¡å‹çš„è¡¨æƒ…å˜åŒ–ã€‚

### è¯­éŸ³åˆæˆ

æ”¯æŒå°†æ–‡æœ¬è½¬æ¢ä¸ºè¯­éŸ³ï¼Œåˆ†å¥å¤„ç†å¹¶è¿”å›æ¯å¥å¯¹åº”çš„éŸ³é¢‘æ•°æ®ï¼Œå®ç°æ›´è‡ªç„¶çš„è¯­éŸ³æ’­æ”¾æ•ˆæœã€‚

### å¯¹è¯å†å²ç®¡ç†

è‡ªåŠ¨ç®¡ç†å¯¹è¯å†å²ï¼Œé™åˆ¶å†å²è®°å½•é•¿åº¦ï¼Œç¡®ä¿ç³»ç»Ÿæ€§èƒ½å’Œä¸Šä¸‹æ–‡ç›¸å…³æ€§ã€‚

## é”™è¯¯å¤„ç†

å„æœåŠ¡ç»„ä»¶å‡å®ç°äº†é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œåœ¨å‡ºç°å¼‚å¸¸æ—¶è¿”å›å‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§ã€‚

## éƒ¨ç½²è¦æ±‚

- Python 3.10+
- ç›¸å…³ä¾èµ–åŒ… (fastapi, uvicorn, openai, python-dotenv ç­‰)
- ç¯å¢ƒå˜é‡é…ç½® (API å¯†é’¥ç­‰)


## APIè°ƒç”¨æŒ‡å—

dashscope è°ƒç”¨ç¤ºæ„å›¾
```
+------------------+     +-------------------------+
|                  |     |                         |
| ç”¨æˆ·è¾“å…¥æ¶ˆæ¯     | --> | æ„é€  messages æ ¼å¼       |
| (ä¾‹å¦‚ï¼šä½ å¥½)     |     | [ { role: user, content } ] |
|                  |     |                         |
+------------------+     +-------------------------+
           â†“
+-----------------------------------------------+
|                                               |
| å‘ DashScope å‘é€ POST è¯·æ±‚                   |
| URL: /api/v1/services/aigc/text-generation/generation |
| Headers: Authorization, Content-Type          |
| Body: model + input.messages + parameters     |
|                                               |
+-----------------------------------------------+
           â†“
+------------------------+
|                        |
| æå– response ä¸­çš„     |
| output.text å†…å®¹è¿”å›   |
| ç»™ç”¨æˆ·                |
|                        |
+------------------------+
```
### 1. **API åœ°å€å¿…é¡»ä¸æ¨¡å‹åŒ¹é…**
- ä¸åŒæ¨¡å‹åœ¨ä¸åŒå¹³å°ä¸Šæœ‰ä¸åŒçš„æ¥å£è·¯å¾„ã€‚
- `qwen-plus` å±äºé˜¿é‡Œé€šä¹‰åƒé—®ç³»åˆ—æ¨¡å‹ï¼Œ**ä¸èƒ½ä½¿ç”¨ OpenAI å…¼å®¹è·¯å¾„**ï¼ˆå¦‚ `/compatible-mode/v1`ï¼‰ã€‚
- æ­£ç¡®åœ°å€æ˜¯ï¼š
  ```python
  https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation
  ```
### 2. **è¯·æ±‚æ ¼å¼è¦ç¬¦åˆæ¨¡å‹è§„èŒƒ**
- DashScope çš„ Qwen ç³»åˆ—æ¨¡å‹è¦æ±‚ä½¿ç”¨æ ‡å‡†çš„ **messages** ç»“æ„ï¼š
  ```json
  {
    "model": "qwen-plus",
    "input": {
      "messages": [
        {"role": "user", "content": "ä½ å¥½"}
      ]
    },
    "parameters": {}
  }
  ```
- ä¸å†æ”¯æŒä¼ ç»Ÿçš„ `prompt` å­—æ®µã€‚

---

### 3. **ç¯å¢ƒå˜é‡é…ç½®å¾ˆé‡è¦**
- å¦‚æœæœªè®¾ç½® `DASHSCOPE_API_KEY` æˆ–è®¾ç½®é”™è¯¯ï¼Œå³ä½¿æ¥å£æ­£ç¡®ä¹Ÿä¼šæŠ¥é”™ã€‚
- è®¾ç½®æ–¹å¼ï¼š
  ```bash
  export DASHSCOPE_API_KEY=your_api_key_here
  ```

---

### 4. **æ—¥å¿—å’Œè°ƒè¯•ä¿¡æ¯æ˜¯æ’æŸ¥é—®é¢˜çš„å…³é”®**
- åœ¨ä»£ç ä¸­åŠ å…¥è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼ˆå¦‚è¯·æ±‚åœ°å€ã€æ¨¡å‹åã€å“åº”å†…å®¹ï¼‰ï¼Œå¯ä»¥å¿«é€Ÿå®šä½é—®é¢˜ã€‚
- ç¤ºä¾‹ï¼š
  ```python
  logger.info(f"å‘é€è¯·æ±‚åˆ° {self.api_url}")
  logger.info(f"ä½¿ç”¨çš„æ¨¡å‹: {self.model_name}")
  logger.info(f"API å“åº”: {json.dumps(result, indent=2, ensure_ascii=False)}")
  ```

---

### 5. **ç†è§£æ¨¡å‹æ–‡æ¡£å’Œæ¥å£æ–‡æ¡£éå¸¸é‡è¦**
- DashScope çš„å®˜æ–¹æ–‡æ¡£å¯¹æ¯ç§æ¨¡å‹éƒ½æœ‰æ˜ç¡®è¯´æ˜ï¼š
  - æ”¯æŒçš„æ¥å£è·¯å¾„
  - è¾“å…¥æ ¼å¼ï¼ˆå¦‚ `messages`ï¼‰
  - è¾“å‡ºå­—æ®µï¼ˆå¦‚ `output.text`ï¼‰
